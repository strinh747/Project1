<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Search for recipies</title>
</head>

<body>

  <form id="ingredients-form">
   <label for="ingredients-input">Enter ingredients you have</label>
    <input type="text" id="ingredients-input"><br>
    <input id="select-ingredients" type="submit" value="GO!">
  </form>
  <div id="ingredients-div"></div>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>

  function searchRecipies(ingredients) {

    var encodedIngredients =encodeURI(ingredients);

    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "https://webknox-recipes.p.rapidapi.com/recipes/findByIngredients?number=5&ingredients="+encodedIngredients,
      //"url": "https://webknox-recipes.p.rapidapi.com/recipes/findByIngredients?number=5&ingredients=tomatoes",
      "method": "GET",
      "headers": {
        "x-rapidapi-host": "webknox-recipes.p.rapidapi.com",
        "x-rapidapi-key": "JMI8oJ73JbFA1XPeI85oBxTgNRBNu0U5"
      }
    } 
    $.ajax(settings).done(function (response) {

      if (response.length > 0) {
        console.log(response);
        $("#ingredients-div").empty();

        {
          jQuery.each( response, function( i, item ) {
  
            var recipeName = $("<h1>").text(item.title);
            var imageURL = $("<a>").attr("href", item.image).append(recipeName);
            var Image = $("<img>").attr("src", item.image);
            //var description = $("<h2>").text(getDescription(item.id));
            $("#ingredients-div").append(recipeName, imageURL, Image,);
          });
        }
        
      }
      else {
        //setResponse("Please provide me more ingredients.");
      }

    });
  }

  function getDescription(recipeId) {
    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "https://webknox-recipes.p.rapidapi.com/recipes/"+recipeId+"/summary/",
      "method": "GET",
      "headers": {
        "x-rapidapi-host": "webknox-recipes.p.rapidapi.com",
        "x-rapidapi-key": "JMI8oJ73JbFA1XPeI85oBxTgNRBNu0U5"
      }
    } 
    $.ajax(settings).done(function (response) {
      return response.sumary;
      
    });
  }  


  /*
  function setResponse(val, name) {
    if (!name) {
      name = "Cathy";
    }
    $("#response").append("<strong>" + name + ":</strong> " + val + "<br>");

    // We put the repsonse div in a jquery object. Scrollheight is pure Javascript, so in order to call it, 
    // we have to extract the pure Javascript html element by using [0]. We then call scrollHeight on it. 
    // This returns the height of the scroll track. 
    var scrollHeight = $("#response")[0].scrollHeight;
    // We then put respoonse div in a jquery object and set it's scroll top to be the scroll Height. 
    $("#response").scrollTop(scrollHeight);
  }  
  */

  // Event handler for user clicking the select-artist button
  $("#select-ingredients").on("click", function(event) {
    // Preventing the button from trying to submit the form
    event.preventDefault();
    // Storing the artist name
    var inputIngredients = $("#ingredients-input").val().trim();

    searchRecipies(inputIngredients);
  });
</script>

</html>
